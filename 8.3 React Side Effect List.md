**React가 공식적으로 Side Effect로 간주하고 `useEffect/useLayoutEffect`로 보내야 하는 모든 실전 사례** 들을 소개합니다.


# 🚨 React에서 발생하는 **실제 Side Effect 리스트**

## — 렌더 함수에서 절대 수행하면 안 되는 모든 작업들 —

React의 Side Effect는 크게 세 부류로 나뉩니다:

---

# 1️⃣ **브라우저 환경 변경(Browser Environment Mutation)**

렌더 외부의 브라우저 상태를 변경하는 모든 행위
→ 무조건 Side Effect

## ✔ 1. 문서 관련

* `document.title = ...`
* `document.body.style = ...`
* `<meta>` 태그 변경
* `document.cookie = ...`

## ✔ 2. Storage 관련

* `localStorage.setItem(key, value)`
* `sessionStorage.setItem(key, value)`
* `indexedDB` read/write

## ✔ 3. URL / History 변경

* `window.history.pushState(...)`
* `history.replaceState(...)`
* `window.location = ...`
* `window.location.hash = ...`

## ✔ 4. 브라우저 전역 속성

* `navigator.clipboard.writeText(...)`
* `Notification.requestPermission()`
* `matchMedia` 등록 & 제거
* `window.scrollTo(...)`

---

# 2️⃣ **DOM 조작(DOM Manipulation)**

React의 관리 밖에서 DOM을 직접 건드리는 모든 작업
→ 100% Side Effect

## ✔ 1. 직접 DOM 갱신

* `document.getElementById(...)`
* `element.innerHTML = ...`
* `element.style.xxx = ...`

## ✔ 2. 서드파티 라이브러리 DOM 조작

* jQuery(`$('#id').fadeIn()`)
* D3.js 직접 DOM 조작
* chart.js의 canvas 초기화 / destroy
* ApexCharts, Swiper.js 등 UI lib 초기화

## ✔ 3. 포커스 & 스크롤 위치 변경

* `element.focus()`
* `element.scrollIntoView()`
* `window.scrollTo()`

---

# 3️⃣ **네트워크 관련(Networking & I/O)**

외부 리소스를 읽거나 쓰는 모든 작업은 Side Effect

## ✔ 1. HTTP 요청

* `fetch('/api/...')`
* `axios.get(...)`, `axios.post(...)`
* GraphQL 클라이언트 요청(Apollo, Relay 등)
* 이미지 프리로드(new Image())

## ✔ 2. WebSocket / SSE / Streaming

* `new WebSocket(url)`
* `webSocket.send(...)`
* `EventSource` 구독(SSE)
* gRPC(streaming) 요청

## ✔ 3. 파일 I/O

* File API (input file)
* FileReader
* Blob 생성 및 다운로드 트리거

---

# 4️⃣ **타이머 & 비동기 핸들링(Timers / Async Scheduling)**

React 렌더링과 무관한 시간 기반 모듈은 모두 Side Effect

## ✔ 1. 타이머

* `setTimeout(...)`
* `setInterval(...)`
* `requestAnimationFrame(...)`
* `setImmediate(...)`
* `queueMicrotask(...)`

## ✔ 2. 외부 async 작업

* 백그라운드 async 함수 실행
* debounce/throttle (lodash)

  * 내부적으로 `setTimeout`을 사용하므로 Side Effect

---

# 5️⃣ **이벤트 리스너(Event Listeners)**

React가 관리하지 않는 DOM, window, document 이벤트는 모두 Side Effect

## ✔ 1. DOM 전역 이벤트

* `window.addEventListener('resize', ...)`
* `window.addEventListener('scroll', ...)`
* `document.addEventListener('keydown', ...)`
* 전역 마우스/터치 이벤트

## ✔ 2. 브라우저 생명주기 이벤트

* `visibilitychange`
* `beforeunload`
* `popstate`
* `online/offline`

## ✔ 3. 외부 라이브러리 이벤트 핸들러

* WebSocket.onmessage
* Firebase onSnapshot
* EventEmitter.on(...)

*모두 cleanup이 반드시 필요합니다.*

---

# 6️⃣ **애니메이션(Animation / Transition)**

DOM 조작이나 API 호출 기반의 애니메이션 초기화는 Side Effect

## ✔ 1. CSS Transition 시작하기

* 클래스 추가/제거로 transition triggering

## ✔ 2. JavaScript 애니메이션

* `element.animate(...)`
* D3 Transition
* GreenSock(GSAP) 애니메이션

---

# 7️⃣ **전역 객체(Global Mutable State) 변경**

React state가 아닌 외부 전역 객체 변경은 전부 Side Effect

## ✔ 1. 글로벌 싱글톤 변경

* 외부 예측 불가능한 cache 객체 조작
* window/global 스코프 변수 변경

## ✔ 2. Redux store 직접 dispatch

* React-Redux는 렌더 후 실행되므로 OK이지만
  직접 store를 건드리는 코드(store.subscribe) 자체는 Side Effect

## ✔ 3. Zustand 등 외부 스토어 read/write

* 외부 공유 상태는 React 렌더와 별개이므로 Side Effect

---

# 8️⃣ **리소스 할당 및 해제(Resource Allocation)**

리소스를 생성/파괴/연결하는 작업

## ✔ 1. WebGL context 생성

* canvas.getContext("webgl")
* Three.js scene 초기화

## ✔ 2. Media API

* getUserMedia
* 오디오 스트림
* 비디오 스트림

## ✔ 3. MutationObserver / IntersectionObserver

* 관찰 시작
* 언마운트 시 disconnect 필요

---

# 9️⃣ **로그 및 모니터링(Log/Analytics)**

렌더링이 여러 번 실행될 수 있으므로 로그를 직접 찍는 것도 Side Effect

## ✔ 1. 로깅

* `console.log()`
* Sentry 에러 로깅
* Firebase Analytics
* GA(Google Analytics) 이벤트

---

# 🔟 **React 외부 환경과 동기화(Synchronization with external environment)**

UI 상태를 React 외부(브라우저/서버/전역)에 맞추는 것

## ✔ 1. UI ↔ 서버 동기화

* push 알림 상태 sync
* 실시간 채팅 read 상태 sync

## ✔ 2. UI ↔ localStorage sync

* 테마 저장
* 최근 열람 목록 저장

## ✔ 3. UI ↔ URL sync

* search params 관리
* modal open 여부를 URL에 반영

---

# 🧨 특별 카테고리: **“렌더링을 오염시키는 모든 동작” = 무조건 Side Effect**

React가 렌더링을 여러 번 실행할 수 있기 때문에
**아래 행동은 모두 “렌더 단계에서 실행하면 위험한 Side Effect”입니다.**

### ❌ 렌더 단계에서 하면 절대 안 되는 것들

1. DOM 조작
2. 타이머 생성
3. fetch 호출
4. 파일 읽기
5. 전역 이벤트 등록
6. 전역 변수 변경
7. localStorage read/write
8. crypto.randomUUID() 호출도 사실상 pure하지 않음
9. Date.now() 만큼도 가능하면 effect 안으로 보내는 게 원칙

---

# 🟩 React가 공식적으로 인정한 Side Effect 카테고리

React docs 기준 Side Effect는 다음 3개로 요약됩니다:

### 1. **서버에서 데이터 가져오기(fetching data)**

### 2. **브라우저 API 사용(localStorage, title, scroll 등)**

### 3. **서드파티 라이브러리 연동(DOM 조작 포함)**

React 공식 문서는 모든 이러한 동작을
**Effect에서만 실행해야 한다**고 가이드합니다.

---

# 📌 결론: React Side Effect 전체 정리

> **React의 Side Effect =
> UI 렌더링이라는 “순수 계산” 외부에서
> 브라우저/서버/전역환경/시간/리소스를 건드리는
> 모든 작업 전체를 의미한다.**


