Reactì˜ `useImperativeHandle`ì€ **â€œë¶€ë“ì´í•  ë•Œ ì“°ëŠ” ë¹„ë°€ í†µë¡œâ€** ê°™ì€ í›…ì…ë‹ˆë‹¤.
ë¶€ëª¨ê°€ ìì‹ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì˜ ë©”ì„œë“œë‚˜ ê°’ì„ *ëª…ë ¹í˜•ìœ¼ë¡œ* í˜¸ì¶œí•´ì•¼ í•  ë•Œ, ê·¸ë•Œë§Œ ì‚´ì§ ë¬¸ì„ ì—´ì–´ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ğŸ˜Š

ì•„ë˜ì—ì„œ ê°œë… â†’ ë¬¸ë²• â†’ ì˜ˆì œ â†’ ë‚´ë¶€ ë™ì‘ â†’ ì£¼ì˜ì‚¬í•­ê¹Œì§€ ì •ë¦¬í•´ ë³´ê² ìŠµë‹ˆë‹¤.

---

## 0. í•œ ì¤„ ì •ì˜ ğŸ§ 

> **`useImperativeHandle`ì€ `forwardRef`ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬, ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ `ref.current`ë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” â€œì»¤ìŠ¤í…€ ì¸ìŠ¤í„´ìŠ¤ ê°ì²´â€ë¥¼ ì •ì˜í•˜ëŠ” í›…**ì…ë‹ˆë‹¤.
> ì¦‰, *â€œDOM ë…¸ë“œë‚˜ ìì‹ ì „ì²´â€ ëŒ€ì‹ , ë‚´ê°€ í—ˆìš©í•œ ë©”ì„œë“œ/ê°’ë§Œ refë¡œ ë…¸ì¶œ*í•˜ê²Œ í•´ ì¤ë‹ˆë‹¤.

---

## 1. ì™œ `useImperativeHandle`ì´ í•„ìš”í•œê°€? ğŸ¤”

ì›ë˜ `ref`ëŠ” ë‘ ê°€ì§€ì— ë§ì´ ì”ë‹ˆë‹¤.

1. **DOMì— ì§ì ‘ ì ‘ê·¼** (ì˜ˆ: `<input>`ì— í¬ì»¤ìŠ¤ ì£¼ê¸°)
2. **ìì‹ ì»´í¬ë„ŒíŠ¸ ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ê·¼** (í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ì—ì„œ `this.someMethod()` í˜¸ì¶œí•˜ë˜ ê²ƒ)

í•˜ì§€ë§Œ í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ ì‹œëŒ€ì—ëŠ”:

* í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ëŠ” `new`ë¡œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì§€ ì•ŠìŠµë‹ˆë‹¤.
* ê·¸ë˜ì„œ ê¸°ë³¸ì ìœ¼ë¡œëŠ” **í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì— refë¥¼ ë‹¬ë©´, DOMì´ ì•„ë‹ˆë¼ â€œê·¸ ì»´í¬ë„ŒíŠ¸ì˜ DOM ë£¨íŠ¸ ë…¸ë“œâ€ë¥¼ refë¡œ ë°›ëŠ” ì‹**ìœ¼ë¡œ ì“°ëŠ” ê²Œ ì¼ë°˜ì ì…ë‹ˆë‹¤. (forwardRefë¡œ ë„˜ê²¨ì„œ)

ë¬¸ì œëŠ”, ë•Œë•Œë¡œ ì´ëŸ° ìš”êµ¬ê°€ ìˆìŠµë‹ˆë‹¤:

* ë¶€ëª¨ê°€ ìì‹ì˜ ë©”ì„œë“œë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ê³  ì‹¶ë‹¤.

  * ì˜ˆ: `childRef.current.focus()`
  * ì˜ˆ: `modalRef.current.open()`, `modalRef.current.close()`
  * ì˜ˆ: `formRef.current.validate()`, `formRef.current.reset()`
* ê·¸ëŸ°ë° **ìì‹ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ êµ¬í˜„(DOM êµ¬ì¡°)ì„ ìˆ¨ê¸°ê³  ì‹¶ë‹¤.**

ì´ë•Œ `useImperativeHandle`ì„ ì‚¬ìš©í•˜ë©´,

* ë¶€ëª¨ ì…ì¥: `ref.current`ì— **â€œë…¸ì¶œí•˜ê³  ì‹¶ì€ ë©”ì„œë“œë§Œ ë‹´ê¸´ ê°ì²´â€**ë¥¼ ë°›ê²Œ ë˜ê³ ,
* ìì‹ ì…ì¥: ë‚´ë¶€ DOM êµ¬ì¡°/ìƒíƒœëŠ” ê°ì¶”ê³ , ì¼ë¶€ ë©”ì„œë“œë§Œ ì™¸ë¶€ì— ë…¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ê²Œ ë°”ë¡œ **â€œëª…ë ¹í˜• í•¸ë“¤(Imperative Handle)â€**ì…ë‹ˆë‹¤. ğŸ”§

---

## 2. ê¸°ë³¸ ë¬¸ë²• & ì‹œê·¸ë‹ˆì²˜ ğŸ“œ

### ê³µì‹ ì‹œê·¸ë‹ˆì²˜

```ts
useImperativeHandle<T, R = T>(
  ref: React.RefObject<T> | React.MutableRefObject<T> | ((instance: T | null) => void),
  createHandle: () => R,
  deps?: readonly any[]
): void
```

ì¼ë°˜ ì‚¬ìš© íŒ¨í„´(JavaScript):

```tsx
import React, { forwardRef, useImperativeHandle, useRef } from 'react';

const Child = forwardRef((props, ref) => {
  // ë‚´ë¶€ì—ì„œ ì§„ì§œ DOMì´ë‚˜ ìƒíƒœë¥¼ ê´€ë¦¬
  const inputRef = useRef(null);

  useImperativeHandle(ref, () => ({
    focus() {
      if (inputRef.current) {
        inputRef.current.focus();
      }
    },
    clear() {
      if (inputRef.current) {
        inputRef.current.value = '';
      }
    },
  }), []); // depsëŠ” ë‚˜ì¤‘ì— ì„¤ëª…

  return <input ref={inputRef} placeholder="ìì‹ ì»´í¬ë„ŒíŠ¸ ì¸í’‹" />;
});

export default Child;
```

ë¶€ëª¨ì—ì„œ:

```tsx
function Parent() {
  const childRef = useRef(null);

  const handleFocus = () => {
    childRef.current?.focus();
  };

  const handleClear = () => {
    childRef.current?.clear();
  };

  return (
    <div>
      <Child ref={childRef} />
      <button onClick={handleFocus}>í¬ì»¤ìŠ¤</button>
      <button onClick={handleClear}>ì§€ìš°ê¸°</button>
    </div>
  );
}
```

ì—¬ê¸°ì„œ ì¤‘ìš”í•œ í¬ì¸íŠ¸:

* `forwardRef`ë¡œ ìì‹ì´ `ref`ë¥¼ ë°›ì„ ìˆ˜ ìˆê²Œ ê°ì‹¸ì•¼ í•©ë‹ˆë‹¤.
* `useImperativeHandle(ref, () => ({ ... }))` ì•ˆì—ì„œ

  * **ë¶€ëª¨ê°€ ì‚¬ìš©í•  `ref.current` ê°ì²´ì˜ â€œëª¨ì–‘â€ê³¼ â€œë©”ì„œë“œâ€ë¥¼ ì •ì˜**í•©ë‹ˆë‹¤.
  * ë¶€ëª¨ ì…ì¥ì—ì„œëŠ” `Child` ì»´í¬ë„ŒíŠ¸ì˜ â€œê³µê°œ APIâ€ë§Œ ë³´ê²Œ ë˜ëŠ” ì…ˆì…ë‹ˆë‹¤.

---

## 3. `forwardRef` + `useImperativeHandle` êµ¬ì¡° í•œëˆˆì— ë³´ê¸° ğŸ”

ìì‹ ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°ë¥¼ ë„ì‹ì²˜ëŸ¼ ë³´ë©´:

```tsx
const Child = forwardRef((props, ref) => {
  // 1) ë‚´ë¶€ì—ì„œ ì‹¤ì œ DOM ref, state ë“± ê´€ë¦¬
  const inputRef = useRef(null);

  // 2) useImperativeHandleë¡œ ë¶€ëª¨ì—ê²Œ ë…¸ì¶œí•  ë©”ì„œë“œë¥¼ ì •ì˜
  useImperativeHandle(ref, () => {
    return {
      focus() {
        inputRef.current?.focus();
      },
      clear() {
        if (inputRef.current) inputRef.current.value = '';
      },
    };
  }, []);

  // 3) ë‚´ë¶€ ë Œë”ë§
  return <input ref={inputRef} />;
});
```

ë¶€ëª¨ì—ì„œ:

```tsx
function Parent() {
  const childRef = useRef(null); // ref.current íƒ€ì…ì€ { focus: () => void; clear: () => void } | null

  return (
    <>
      <Child ref={childRef} />
      <button onClick={() => childRef.current?.focus()}>í¬ì»¤ìŠ¤</button>
    </>
  );
}
```

ì¦‰,

* `forwardRef` : ë¶€ëª¨ â†’ ìì‹ìœ¼ë¡œ `ref`ë¥¼ ì „ë‹¬í•˜ëŠ” í†µë¡œ
* `useImperativeHandle` : ê·¸ í†µë¡œë¡œ **â€œì–´ë–¤ ê°ì²´ë¥¼ ë³´ë‚¼ì§€â€** ê²°ì •í•˜ëŠ” í•„í„°

---

## 4. ê°„ë‹¨ ì˜ˆì œ 1 â€“ í¬ì»¤ìŠ¤/í´ë¦¬ì–´ê°€ ê°€ëŠ¥í•œ Input ì»´í¬ë„ŒíŠ¸ âœï¸

### ChildInput.tsx

```tsx
import React, { forwardRef, useImperativeHandle, useRef } from 'react';

export type InputHandle = {
  focus: () => void;
  clear: () => void;
  getValue: () => string;
};

type Props = {
  label?: string;
};

const ChildInput = forwardRef<InputHandle, Props>(({ label }, ref) => {
  const inputRef = useRef<HTMLInputElement | null>(null);

  useImperativeHandle(ref, () => ({
    focus() {
      inputRef.current?.focus();
    },
    clear() {
      if (inputRef.current) {
        inputRef.current.value = '';
      }
    },
    getValue() {
      return inputRef.current?.value ?? '';
    },
  }), []);

  return (
    <div>
      {label && <label style={{ marginRight: 8 }}>{label}</label>}
      <input ref={inputRef} />
    </div>
  );
});

export default ChildInput;
```

### Parent.tsx

```tsx
import React, { useRef } from 'react';
import ChildInput, { InputHandle } from './ChildInput';

function Parent() {
  const inputHandleRef = useRef<InputHandle | null>(null);

  return (
    <div>
      <ChildInput ref={inputHandleRef} label="ì´ë¦„" />
      <button onClick={() => inputHandleRef.current?.focus()}>
        í¬ì»¤ìŠ¤
      </button>
      <button onClick={() => inputHandleRef.current?.clear()}>
        ì§€ìš°ê¸°
      </button>
      <button
        onClick={() => {
          alert(inputHandleRef.current?.getValue());
        }}
      >
        ê°’ ë³´ê¸°
      </button>
    </div>
  );
}

export default Parent;
```

ì—¬ê¸°ì„œ ë¶€ëª¨ëŠ” **DOM ì„¸ë¶€ êµ¬ì¡°ë¥¼ ëª°ë¼ë„** `focus`, `clear`, `getValue`ë§Œ ì•Œê³  ì“°ë©´ ë©ë‹ˆë‹¤.
ë°”ë¡œ ì´ê²ƒì´ **ìº¡ìŠí™” + ëª…ë ¹í˜• í•¸ë“¤**ì˜ ì¥ì ì…ë‹ˆë‹¤. ğŸ’¡

---

## 5. ë‚´ë¶€ ë™ì‘ ë§ˆì¸ë“œì…‹ ğŸ§¬

`useImperativeHandle(ref, createHandle, deps)`ëŠ” í¬ê²Œ ì´ë ‡ê²Œ ë™ì‘í•œë‹¤ê³  ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤:

1. ì»´í¬ë„ŒíŠ¸ê°€ **ë§ˆìš´íŠ¸**ë  ë•Œ

   * `createHandle()`ì„ í˜¸ì¶œí•´ì„œ ê°ì²´ë¥¼ ë§Œë“­ë‹ˆë‹¤.
   * `ref.current = createHandle()`ë¡œ ì„¸íŒ…í•©ë‹ˆë‹¤.
2. `deps`ê°€ ë°”ë€Œì–´ì„œ **ì—…ë°ì´íŠ¸**ë  ë•Œ

   * ë‹¤ì‹œ `createHandle()`ì„ í˜¸ì¶œí•´ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë°˜í™˜í•˜ê³ ,
   * `ref.current`ë¥¼ ê·¸ ê°ì²´ë¡œ êµì²´í•©ë‹ˆë‹¤.
3. ì»´í¬ë„ŒíŠ¸ê°€ **ì–¸ë§ˆìš´íŠ¸**ë  ë•Œ

   * `ref.current = null`ë¡œ ì •ë¦¬í•©ë‹ˆë‹¤.

ê·¸ë˜ì„œ:

* `deps`ë¥¼ `[]`ë¡œ ë‘ë©´, **í•œ ë²ˆë§Œ í•¸ë“¤ì„ ë§Œë“¤ì–´ì„œ ì¬ì‚¬ìš©**í•©ë‹ˆë‹¤.
* ë‚´ë¶€ì—ì„œ ì°¸ì¡°í•˜ëŠ” ê²ƒì´ **ë°”ë€” ìˆ˜ ìˆëŠ” ìƒíƒœ**ë¼ë©´, ê·¸ ìƒíƒœë¥¼ `deps`ì— ë„£ì–´ì„œ ìµœì‹  ìƒíƒœë¥¼ ë°˜ì˜í•´ì•¼ í•©ë‹ˆë‹¤. (ì•„ë˜ ì£¼ì˜ì‚¬í•­ì—ì„œ ì„¤ëª…)

---

## 6. ì‹¤ì „ ì˜ˆì œë“¤ âš”ï¸

### 6-1. Modalì˜ `open`, `close` ë©”ì„œë“œ ë…¸ì¶œí•˜ê¸°

#### Modal.tsx

```tsx
import React, { forwardRef, useImperativeHandle, useState } from 'react';

export type ModalHandle = {
  open: () => void;
  close: () => void;
};

type ModalProps = {
  title: string;
  children?: React.ReactNode;
};

const Modal = forwardRef<ModalHandle, ModalProps>(({ title, children }, ref) => {
  const [isOpen, setIsOpen] = useState(false);

  useImperativeHandle(ref, () => ({
    open() {
      setIsOpen(true);
    },
    close() {
      setIsOpen(false);
    },
  }), []);

  if (!isOpen) return null;

  return (
    <div
      style={{
        position: 'fixed',
        inset: 0,
        background: 'rgba(0,0,0,0.4)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
      }}
    >
      <div style={{ background: 'white', padding: 20, borderRadius: 8, minWidth: 300 }}>
        <h2>{title}</h2>
        <div style={{ marginTop: 10 }}>{children}</div>
        <button onClick={() => setIsOpen(false)}>ë‹«ê¸°</button>
      </div>
    </div>
  );
});

export default Modal;
```

#### Parent.tsx

```tsx
import React, { useRef } from 'react';
import Modal, { ModalHandle } from './Modal';

function Parent() {
  const modalRef = useRef<ModalHandle | null>(null);

  const handleOpen = () => {
    modalRef.current?.open();
  };

  const handleClose = () => {
    modalRef.current?.close();
  };

  return (
    <div>
      <button onClick={handleOpen}>ëª¨ë‹¬ ì—´ê¸°</button>
      <button onClick={handleClose}>ëª¨ë‹¬ ë‹«ê¸°</button>

      <Modal ref={modalRef} title="ì•Œë¦¼">
        <p>useImperativeHandleë¡œ ì œì–´í•˜ëŠ” ëª¨ë‹¬ì…ë‹ˆë‹¤.</p>
      </Modal>
    </div>
  );
}

export default Parent;
```

ì´ íŒ¨í„´ì€ **ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ëª¨ë‹¬, ë“œë¡œì–´, í† ìŠ¤íŠ¸ ë“±**ì„ ë§Œë“¤ ë•Œ ê½¤ ìì£¼ ë“±ì¥í•©ë‹ˆë‹¤.

---

### 6-2. ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ë¦¬ìŠ¤íŠ¸ì—ì„œ `scrollToBottom` ì œê³µí•˜ê¸° ğŸ“œ

```tsx
import React, { forwardRef, useImperativeHandle, useRef } from 'react';

export type ScrollableListHandle = {
  scrollToBottom: () => void;
};

type ScrollableListProps = {
  items: string[];
};

const ScrollableList = forwardRef<ScrollableListHandle, ScrollableListProps>(
  ({ items }, ref) => {
    const containerRef = useRef<HTMLDivElement | null>(null);

    useImperativeHandle(ref, () => ({
      scrollToBottom() {
        const el = containerRef.current;
        if (!el) return;
        el.scrollTop = el.scrollHeight;
      },
    }), []);

    return (
      <div
        ref={containerRef}
        style={{
          maxHeight: 200,
          overflowY: 'auto',
          border: '1px solid #ccc',
          padding: 8,
        }}
      >
        {items.map((item, idx) => (
          <div key={idx}>{item}</div>
        ))}
      </div>
    );
  }
);

export default ScrollableList;
```

ë¶€ëª¨:

```tsx
function Chat() {
  const listRef = useRef<ScrollableListHandle | null>(null);
  const [messages, setMessages] = React.useState<string[]>([]);

  const addMessage = () => {
    setMessages((prev) => [...prev, `ë©”ì‹œì§€ ${prev.length + 1}`]);
    // setStateëŠ” ë¹„ë™ê¸°ë¼ ë‹¤ìŒ ë Œë” ì´í›„ì— ìŠ¤í¬ë¡¤ í•˜ë ¤ë©´, useEffectë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´ë„ ìˆìŒ
    // ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœ ì˜ˆì‹œ
    setTimeout(() => listRef.current?.scrollToBottom(), 0);
  };

  return (
    <div>
      <button onClick={addMessage}>ë©”ì‹œì§€ ì¶”ê°€</button>
      <ScrollableList ref={listRef} items={messages} />
    </div>
  );
}
```

---

## 7. `useImperativeHandle` vs ê·¸ëƒ¥ `ref` vs `useRef` ğŸ“š

### 7-1. ê·¸ëƒ¥ DOM refë§Œ ì“¸ ë•Œ

```tsx
const Input = forwardRef((props, ref) => {
  return <input ref={ref} />;
});
```

* ë¶€ëª¨ëŠ” `ref.current`ë¡œ **ê·¸ëƒ¥ DOM ë…¸ë“œ**ë¥¼ ë°›ìŠµë‹ˆë‹¤.
* DOM ë©”ì„œë“œ(`.focus()`, `.scrollIntoView()`, ...)ë§Œ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 7-2. `useImperativeHandle`ì„ ì“¸ ë•Œ

```tsx
const Input = forwardRef((props, ref) => {
  const innerRef = useRef(null);

  useImperativeHandle(ref, () => ({
    focus() {
      innerRef.current?.focus();
    },
    clear() {
      if (innerRef.current) innerRef.current.value = '';
    },
  }), []);

  return <input ref={innerRef} />;
});
```

* ë¶€ëª¨ëŠ” `ref.current`ë¡œ **ì»¤ìŠ¤í…€ ê°ì²´**ë¥¼ ë°›ìŠµë‹ˆë‹¤.
* DOM ë©”ì„œë“œê°€ ì•„ë‹ˆë¼ `focus`, `clear` ê°™ì€ **ë‚´ê°€ ì„¤ê³„í•œ API**ë§Œ ë³´ê²Œ ë©ë‹ˆë‹¤.
* ìì‹ ë‚´ë¶€ DOM êµ¬ì¡°ë¥¼ ë°”ê¿”ë„, APIë§Œ ìœ ì§€í•˜ë©´ ë¶€ëª¨ ì½”ë“œëŠ” ê·¸ëŒ€ë¡­ë‹ˆë‹¤. (ìº¡ìŠí™”)

---

## 8. ì˜ì¡´ì„± ë°°ì—´(deps)ê³¼ stale closure ë¬¸ì œ âš ï¸

`useImperativeHandle(ref, createHandle, deps)`ì˜ `deps`ëŠ” **â€œí•¸ë“¤ ê°ì²´ê°€ ì–´ë–¤ ê°’ì— ì˜ì¡´í•˜ëŠ”ì§€â€**ë¥¼ Reactì—ê²Œ ì•Œë ¤ì£¼ëŠ” ì—­í• ì…ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, í•¸ë“¤ ì•ˆì—ì„œ `count` ìƒíƒœë¥¼ ì½ëŠ”ë‹¤ë©´:

```tsx
const [count, setCount] = useState(0);

useImperativeHandle(ref, () => ({
  logCount() {
    console.log('í˜„ì¬ count:', count);
  },
}), [count]);
```

* `count`ê°€ ë³€í•  ë•Œë§ˆë‹¤ ìƒˆ í•¸ë“¤ì´ ë§Œë“¤ì–´ì§€ê³ , `ref.current.logCount`ëŠ” ìµœì‹  `count`ë¥¼ ìº¡ì²˜í•©ë‹ˆë‹¤.
* ë§Œì•½ `deps`ë¥¼ `[]`ë¡œ ë‘ë©´,

  * ì²˜ìŒ ë Œë” ë•Œì˜ `count`(ì˜ˆ: 0)ë§Œ ê¸°ì–µí•˜ê³  ê³„ì† ê·¸ ê°’ë§Œ ì¶œë ¥í•˜ëŠ” **stale closure** ë¬¸ì œê°€ ìƒê¹ë‹ˆë‹¤.

**ì‹¤ë¬´ íŒ**:

* í•¸ë“¤ì´ **DOM refë‚˜ stableí•œ í•¨ìˆ˜ë§Œ ì‚¬ìš©**í•œë‹¤ë©´ `[]`ë¡œ ë‘ì–´ë„ ê´œì°®ìŠµë‹ˆë‹¤.
* í•¸ë“¤ ë‚´ë¶€ì—ì„œ **state, props ê°’**ì„ ì½ëŠ”ë‹¤ë©´

  * í•´ë‹¹ ê°’ë“¤ì„ `deps`ì— í¬í•¨ì‹œí‚¤ê±°ë‚˜,
  * í˜¹ì€ `useRef`ë¡œ ìƒíƒœë¥¼ mirrorí•˜ì—¬ ê´€ë¦¬í•˜ëŠ” ë“±ì˜ íŒ¨í„´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

---

## 9. ì„ ì–¸í˜•(Declarative) vs ëª…ë ¹í˜•(Imperative) âš–ï¸

ReactëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **ì„ ì–¸í˜•** íŒ¨í„´ì„ ì§€í–¥í•©ë‹ˆë‹¤.

* â€œìƒíƒœë¥¼ ì´ë ‡ê²Œ ë§Œë“¤ë©´ UIê°€ ì´ë ‡ê²Œ ë³´ì¸ë‹¤â€ëŠ” *ë°ì´í„° â†’ UI* ê´€ê³„ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì •ì„
* ë¶€ëª¨ê°€ ìì‹ì„ ì§ì ‘ ëª…ë ¹(`doSomething()`)í•˜ëŠ” ê²ƒì€ **ê°€ê¸‰ì  í”¼í•˜ë¼**ëŠ” ê²ƒì´ React ì² í•™

ê·¸ë ‡ë‹¤ë©´ `useImperativeHandle`ì€ **ì–¸ì œ ì¨ì•¼ í• ê¹Œ?**

> ğŸ‘‰ â€œì •ë§ ì„ ì–¸í˜•ìœ¼ë¡œ í’€ê¸° ì–´ë ¤ìš´ ë¬¸ì œâ€ë¥¼ ë‹¤ë£° ë•Œ, **ìµœí›„ì˜ ìˆ˜ë‹¨**ì²˜ëŸ¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

ì˜ˆ:

* í¬ì»¤ìŠ¤ ì œì–´
* ìŠ¤í¬ë¡¤ ì œì–´
* ì• ë‹ˆë©”ì´ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—°ë™
* ë§¤ìš° ë³µì¡í•œ third-party DOM ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ì˜ ë¸Œë¦¿ì§€

**ìƒíƒœ ë³€í™”ë¡œ í•´ê²°ë  ìˆ˜ ìˆëŠ” ë¡œì§ì´ë¼ë©´**,
`props`/`state`/`context`ë¡œ í‘œí˜„í•˜ëŠ” ê²ƒì´ ë” ReactìŠ¤ëŸ½ìŠµë‹ˆë‹¤.

---

## 10. TypeScriptì—ì„œì˜ íƒ€ì… ì§€ì • âœï¸

ìì£¼ ì“°ëŠ” íŒ¨í„´:

```tsx
export type SomeHandle = {
  methodA: () => void;
  methodB: (value: string) => number;
};

type Props = { ... };

const SomeComponent = forwardRef<SomeHandle, Props>((props, ref) => {
  useImperativeHandle(ref, () => ({
    methodA() { ... },
    methodB(value) { ... },
  }), []);

  return (...);
});
```

ë¶€ëª¨ì—ì„œ:

```tsx
const someRef = useRef<SomeHandle | null>(null);

// someRef.current?.methodA();
// someRef.current?.methodB('hello');
```

ì´ë ‡ê²Œ í•˜ë©´:

* `ref.current`ì— ëŒ€í•œ ì‚¬ìš© ì‹œì ì— **ìë™ ì™„ì„± + íƒ€ì… ì²´í¬**ê°€ ì˜ ë©ë‹ˆë‹¤.
* ì‹¤ìˆ˜ë¡œ `ref.current.nonExistMethod()` ê°™ì€ ê±¸ í˜¸ì¶œí•˜ë©´ ì»´íŒŒì¼ ì—ëŸ¬ë¡œ ì¡ì•„ì¤ë‹ˆë‹¤. âœ…

---

## 11. ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ & ì£¼ì˜ì‚¬í•­ ğŸ”

1. **`forwardRef`ë¥¼ ì•ˆ ì“°ê³  useImperativeHandleë§Œ ì“°ëŠ” ê²½ìš°**

   * `useImperativeHandle`ì€ ë°˜ë“œì‹œ `forwardRef` ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
   * ì•„ë‹ˆë©´ Reactê°€ `ref`ë¥¼ ì „ë‹¬í•  í†µë¡œê°€ ì—†ìŠµë‹ˆë‹¤.

2. **ì˜ì¡´ì„± ë°°ì—´ì„ ë¬´ì‹œ**

   * í•¸ë“¤ ë‚´ë¶€ì—ì„œ state, propsë¥¼ ì‚¬ìš©í•˜ë©´ì„œë„ `[]`ë¡œ ë‘ë©´ stale ë°ì´í„° ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.
   * ê¼­ í•„ìš”í•œ ê°’ì€ `deps`ì— ë„£ê±°ë‚˜ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.

3. **ê³¼ë„í•œ ì‚¬ìš©**

   * ìê¾¸ `ref.current.xxx()`ë¡œ í˜¸ì¶œí•˜ëŠ” íŒ¨í„´ì´ ëŠ˜ì–´ë‚˜ë©´, ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°ê°€ â€œëª…ë ¹í˜• ìŠ¤íŒŒê²Œí‹° ì½”ë“œâ€ê°€ ë˜ê¸° ì‰½ìŠµë‹ˆë‹¤.
   * *"ì´ê±¸ ìƒíƒœë¡œ í’€ ìˆ˜ëŠ” ì—†ì„ê¹Œ?"*ë¥¼ ë¨¼ì € ê³ ë¯¼í•œ í›„, ì•ˆ ë  ë•Œ ì“°ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.

4. **DOMì„ ê·¸ëŒ€ë¡œ ë…¸ì¶œ vs ì»¤ìŠ¤í…€ APIë§Œ ë…¸ì¶œ**

   * `useImperativeHandle` ì•ˆì—ì„œ ê·¸ëƒ¥ `return inputRef.current` ê°™ì€ ì‹ìœ¼ë¡œ DOMë§Œ ì „ë‹¬í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
   * í•˜ì§€ë§Œ ê·¸ê²ƒë³´ë‹¤ëŠ” **ë‚´ë¶€ êµ¬í˜„ì„ ìˆ¨ê¸°ê³ , ìµœì†Œí•œì˜ APIë§Œ ë…¸ì¶œí•˜ëŠ” ê²ƒì´ ë” ì¢‹ì€ ì„¤ê³„**ì…ë‹ˆë‹¤.

---

## 12. ì–¸ì œ ì“°ë©´ ì¢‹ì€ì§€ ì •ë¦¬ ğŸ¯

**ì ì ˆí•œ ì‚¬ìš© ì˜ˆì‹œ**

* í¬ì»¤ìŠ¤/ìŠ¤í¬ë¡¤/ì• ë‹ˆë©”ì´ì…˜/í”Œë ˆì´/ì •ì§€ ë“±,

  * **â€œUIì˜ ë¬¼ë¦¬ì ì¸ ë™ì‘â€ì„ ë¶€ëª¨ê°€ ì§ì ‘ ì œì–´**í•´ì•¼ í•  ë•Œ
* Form ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ í•„ë“œ ì»´í¬ë„ŒíŠ¸ê°€ `validate()`, `reset()` ê°™ì€ ë©”ì„œë“œë¥¼ ì œê³µí•  ë•Œ
* ì™¸ë¶€ DOM ê¸°ë°˜ ë¼ì´ë¸ŒëŸ¬ë¦¬(ì°¨íŠ¸, ìº”ë²„ìŠ¤, ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ ë“±)ë¥¼ ë˜í•‘í•  ë•Œ

**í”¼í•´ì•¼ í•  ì‚¬ìš© ì˜ˆì‹œ**

* ë‹¨ìˆœíˆ ë°ì´í„° ì „ë‹¬/ìƒíƒœ ë³€ê²½ì„ ìœ„í•´

  * â†’ props/state/contextë¡œ í•´ê²° ê°€ëŠ¥
* ë¶€ëª¨/ìì‹ ê°„ í˜¸ì¶œì´ ë’¤ì—‰ì¼œì„œ êµ¬ì¡°ë¥¼ ë³µì¡í•˜ê²Œ ë§Œë“œëŠ” ê²½ìš°

---

## 13. ìš”ì•½ ğŸ§¾

* `useImperativeHandle`ì€ **ë¶€ëª¨ê°€ ìì‹ì˜ ë‚´ë¶€ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” â€œëª…ë ¹í˜• API í›…â€**ì…ë‹ˆë‹¤.
* ë°˜ë“œì‹œ `forwardRef`ì™€ í•¨ê»˜ ì‚¬ìš©í•©ë‹ˆë‹¤.
* `useImperativeHandle(ref, () => ({ ... }), deps)` ì•ˆì—ì„œ
  **refë¡œ ë…¸ì¶œí•  ë©”ì„œë“œ/ê°’ì„ ì •ì˜**í•©ë‹ˆë‹¤.
* ì˜ì¡´ì„± ë°°ì—´ì„ ì˜ëª» ì‚¬ìš©í•˜ë©´ **stale closure** ë¬¸ì œê°€ ìƒê¹ë‹ˆë‹¤.
* Reactì˜ ì„ ì–¸í˜• ì² í•™ê³¼ ìƒì¶©ë˜ë¯€ë¡œ, **ì •ë§ í•„ìš”í•  ë•Œë§Œ** ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

