ë¦¬ì•¡íŠ¸ì˜ **useReducer**ëŠ” ì‚¬ì‹¤ìƒ â€œì»´í¬ë„ŒíŠ¸ ì•ˆì— ë“¤ì–´ìˆëŠ” ë¯¸ë‹ˆ ìƒíƒœ ë¨¸ì‹ (state machine) í›…â€ì´ë¼ê³  ë³´ì‹œë©´ ë©ë‹ˆë‹¤. ğŸ’¡
ë‹¨ìˆœ ì¹´ìš´í„°ë¥¼ ë„˜ì–´ì„œ **ë³µì¡í•œ ìƒíƒœ / ì—¬ëŸ¬ ì•¡ì…˜ / ëª…í™•í•œ ìƒíƒœ ì „ì´**ë¥¼ í‘œí˜„í•  ë•Œ ì§„ê°€ê°€ ë“œëŸ¬ë‚˜ìš”.

ì•„ë˜ì—ì„œëŠ”

1. ì™œ useState ë§ê³  useReducerì¸ê°€?
2. ê¸°ë³¸ ë¬¸ë²•ê³¼ ë™ì‘ ì›ë¦¬
3. ëŒ€í‘œ ì˜ˆì œë“¤ (ì¹´ìš´í„°, í¼, Todo)
4. lazy init, ì„±ëŠ¥/êµ¬ì¡°ì  ì¥ì 
5. Contextì™€ ê²°í•©í•´ â€œë¯¸ë‹ˆ Reduxâ€ ë§Œë“¤ê¸°
6. ë‚´ë¶€ êµ¬í˜„( Fiber / hook.memoizedState ì—°ê´€ )
7. Reduxì™€ ë¹„êµ
8. ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ & íŒ

ê¹Œì§€ íŒŒë³´ê² ìŠµë‹ˆë‹¤. ğŸ˜

---

## 1. ì™œ useState ë§ê³  useReducerì¸ê°€? ğŸ¤”

### 1-1. useStateë¡œëŠ” ì ì  ì½”ë“œê°€ ë§ê°€ì§€ëŠ” ìˆœê°„

ì²˜ìŒì—ëŠ” ì´ë ‡ê²Œ ì‹œì‘í•˜ì£ :

```jsx
const [title, setTitle] = useState('');
const [content, setContent] = useState('');
const [isSubmitting, setIsSubmitting] = useState(false);
const [error, setError] = useState(null);
```

ì¡°ê¸ˆë§Œ ë³µì¡í•´ì ¸ë„:

* í•œ ì´ë²¤íŠ¸ì—ì„œ **ì—¬ëŸ¬ stateë¥¼ ë™ì‹œì—** ì—…ë°ì´íŠ¸
* ë¡œë”© â†’ ì„±ê³µ â†’ ì‹¤íŒ¨ì™€ ê°™ì´ **â€œìƒíƒœ ì „ì´â€**ê°€ ëª…í™•í•œ íë¦„ í•„ìš”
* â€œì·¨ì†Œ, ë¦¬ì…‹, ë˜ëŒë¦¬ê¸°â€ ê°™ì€ **ì•¡ì…˜ë“¤ì´ ë§ì•„ì§ˆ ë•Œ**

ì´ë•Œë¶€í„° `setXXX()`ê°€ ì‚¬ë°©ì—ì„œ ë‚œë¬´í•˜ê³ ,
â€œì´ ì•¡ì…˜ì´ ì˜¤ë©´ ì–´ë–¤ stateë“¤ì´ ì–´ë–»ê²Œ ë°”ë€Œì–´ì•¼ í•˜ì§€?â€ë¥¼ ì¶”ì í•˜ê¸°ê°€ ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤.

### 1-2. useReducerê°€ í•´ê²°í•˜ëŠ” ê²ƒ

useReducerëŠ” ì´ëŸ° ìƒí™©ì—ì„œ:

* ìƒíƒœë¥¼ í•˜ë‚˜ì˜ **state ê°ì²´**ë¡œ ë¬¶ê³ 
* ìƒíƒœ ë³€ê²½ì„ **reducer í•¨ìˆ˜** í•œ ê³³ì— ëª¨ì•„ì„œ
* â€œì•¡ì…˜ â†’ ìƒíƒœ ì „ì´â€ë¥¼ **ëª…ì‹œì ìœ¼ë¡œ** í‘œí˜„í•©ë‹ˆë‹¤.

ì¦‰,

> â€œì´ë²¤íŠ¸ ë°œìƒ ì‹œ, dispatchë¡œ ì•¡ì…˜ì„ ë˜ì§€ê³ ,
> ìƒíƒœê°€ ì–´ë–»ê²Œ ë°”ë€ŒëŠ”ì§€ëŠ” reducerì—ì„œ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤â€

ë¼ëŠ” êµ¬ì¡°ë¥¼ ê°•ì œí•˜ëŠ” í›…ì…ë‹ˆë‹¤.
ì´ê²Œ êµ¬ì¡°ì  ì„¤ê³„ì™€ ìœ ì§€ë³´ìˆ˜ ê´€ì ì—ì„œ êµ‰ì¥íˆ í° ì¥ì ì´ì—ìš”. ğŸ’ª

---

## 2. useReducer ê¸°ë³¸ ë¬¸ë²• ğŸ§©

ê¸°ë³¸ ì‹œê·¸ë‹ˆì²˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

```ts
const [state, dispatch] = useReducer(reducer, initialArg, init?)
```

* **reducer**: `(state, action) => newState`
* **state**: í˜„ì¬ ìƒíƒœ ê°’ (ìˆ«ì, ê°ì²´, ë°°ì—´ ë‹¤ ê°€ëŠ¥)
* **dispatch**: ì•¡ì…˜ì„ reducerë¡œ ì „ë‹¬í•˜ëŠ” í•¨ìˆ˜
* **initialArg**: ì´ˆê¸° ìƒíƒœ ê°’ ë˜ëŠ” ì´ˆê¸°í™”ì— í•„ìš”í•œ ê°’
* **init?**: (ì„ íƒ) lazy ì´ˆê¸°í™”ë¥¼ ìœ„í•œ í•¨ìˆ˜

ì˜ˆë¥¼ ë“¤ì–´:

```jsx
function reducer(state, action) {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 }
    case 'decrement':
      return { count: state.count - 1 }
    case 'reset':
      return { count: 0 }
    default:
      throw new Error(`Unhandled action type: ${action.type}`)
  }
}

const [state, dispatch] = useReducer(reducer, { count: 0 })
```

ì—¬ê¸°ì„œ ì¤‘ìš”í•œ í¬ì¸íŠ¸:

1. **reducerëŠ” ìˆœìˆ˜ í•¨ìˆ˜**ì—¬ì•¼ í•©ë‹ˆë‹¤.

   * ê°™ì€ `state`ì™€ `action`ì´ ë“¤ì–´ì˜¤ë©´ í•­ìƒ ê°™ì€ `newState`ë¥¼ ë°˜í™˜
   * ë‚´ë¶€ì—ì„œ `fetch`, `console.log`, DOM ì¡°ì‘ ë“±ì„ í•˜ë©´ ì•ˆ ë¨ (side effect ê¸ˆì§€)
2. **stateë¥¼ ì§ì ‘ mutateí•˜ë©´ ì•ˆ ë¨**

   * `state.count++` ê°™ì€ ê±´ ê¸ˆì§€
   * í•­ìƒ **ìƒˆë¡œìš´ ê°ì²´/ë°°ì—´**ì„ ë§Œë“¤ì–´ ë°˜í™˜í•´ì•¼ í•¨

---

## 3. ê°€ì¥ ê¸°ë³¸ì ì¸ ì˜ˆì œ: ì¹´ìš´í„° ğŸ”¢

### 3-1. ì½”ë“œ

```jsx
import { useReducer } from 'react'

function counterReducer(state, action) {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 }
    case 'decrement':
      return { count: state.count - 1 }
    case 'reset':
      return { count: 0 }
    default:
      throw new Error(`Unknown action type: ${action.type}`)
  }
}

function Counter() {
  const [state, dispatch] = useReducer(counterReducer, { count: 0 })

  return (
    <div>
      <p>í˜„ì¬ ì¹´ìš´íŠ¸: {state.count}</p>
      <button onClick={() => dispatch({ type: 'decrement' })}>-1</button>
      <button onClick={() => dispatch({ type: 'increment' })}>+1</button>
      <button onClick={() => dispatch({ type: 'reset' })}>ë¦¬ì…‹</button>
    </div>
  )
}

export default Counter
```

### 3-2. ë™ì‘ íë¦„ ğŸ§ 

1. ì²˜ìŒ ë Œë”ë§ ì‹œ
   `useReducer(counterReducer, { count: 0 })`
   â†’ stateëŠ” `{ count: 0 }`ë¡œ ì´ˆê¸°í™”, `dispatch` í•¨ìˆ˜ ìƒì„±

2. ë²„íŠ¼ í´ë¦­ ì‹œ

   ```js
   dispatch({ type: 'increment' })
   ```

   * React ë‚´ë¶€ì˜ `dispatch` êµ¬í˜„ì´

     * í˜„ì¬ stateì™€ actionì„ reducerì— ì „ë‹¬
     * `const newState = reducer(prevState, action)`
     * `Object.is(prevState, newState)`ê°€ falseë©´ **re-render** ìŠ¤ì¼€ì¤„ë§

3. ì»´í¬ë„ŒíŠ¸ ì¬ì‹¤í–‰

   * ê°™ì€ ìˆœì„œì˜ useReducer í›…ì„ ë‹¤ì‹œ ì½ê³ 
   * ìƒˆë¡œìš´ state ê°’(`{ count: 1 }`)ì„ ë°˜í™˜

ì´ íŒ¨í„´ì€ Reduxì™€ ê±°ì˜ ë™ì¼í•œ mental modelì´ë¼,
ë‚˜ì¤‘ì— Redux í•™ìŠµ/ê°•ì˜ì—ë„ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°ë©ë‹ˆë‹¤. ğŸ˜‰

---

## 4. ì•¡ì…˜ ì„¤ê³„ì™€ reducer íŒ¨í„´ ğŸ¯

í˜„ì—…/ê°•ì˜ì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì•¡ì…˜ í˜•íƒœëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

```ts
type Action =
  | { type: 'add_todo'; payload: { text: string } }
  | { type: 'toggle_todo'; payload: { id: number } }
  | { type: 'remove_todo'; payload: { id: number } }
```

### 4-1. switch-case íŒ¨í„´ (ê°€ì¥ ì¼ë°˜ì )

```jsx
function todoReducer(state, action) {
  switch (action.type) {
    case 'add_todo': {
      const newTodo = {
        id: Date.now(),
        text: action.payload.text,
        completed: false,
      }
      return { ...state, todos: [...state.todos, newTodo] }
    }
    case 'toggle_todo': {
      return {
        ...state,
        todos: state.todos.map((todo) =>
          todo.id === action.payload.id
            ? { ...todo, completed: !todo.completed }
            : todo
        ),
      }
    }
    case 'remove_todo': {
      return {
        ...state,
        todos: state.todos.filter(
          (todo) => todo.id !== action.payload.id
        ),
      }
    }
    default:
      throw new Error(`Unknown action type: ${action.type}`)
  }
}
```

### 4-2. ê°ì²´ ë§¤í•‘ íŒ¨í„´ (switchë¥¼ í”¼í•˜ê³  ì‹¶ì„ ë•Œ)

```jsx
const handlers = {
  add_todo: (state, action) => {
    const newTodo = {
      id: Date.now(),
      text: action.payload.text,
      completed: false,
    }
    return { ...state, todos: [...state.todos, newTodo] }
  },
  toggle_todo: (state, action) => ({
    ...state,
    todos: state.todos.map((todo) =>
      todo.id === action.payload.id
        ? { ...todo, completed: !todo.completed }
        : todo
    ),
  }),
  remove_todo: (state, action) => ({
    ...state,
    todos: state.todos.filter((todo) => todo.id !== action.payload.id),
  }),
}

function todoReducer(state, action) {
  const handler = handlers[action.type]
  if (!handler) throw new Error(`Unknown action type: ${action.type}`)
  return handler(state, action)
}
```

---

## 5. ë³µì¡í•œ í¼ ìƒíƒœë¥¼ useReducerë¡œ ê´€ë¦¬í•˜ê¸° ğŸ“

### 5-1. ì—¬ëŸ¬ í•„ë“œë¥¼ ê°€ì§„ í¼ + reset

```jsx
import { useReducer } from 'react'

const initialFormState = {
  name: '',
  email: '',
  age: '',
  isSubmitted: false,
}

function formReducer(state, action) {
  switch (action.type) {
    case 'change_field': {
      const { name, value } = action.payload
      return {
        ...state,
        [name]: value,
      }
    }
    case 'submit_success':
      return {
        ...state,
        isSubmitted: true,
      }
    case 'reset':
      return initialFormState
    default:
      throw new Error(`Unknown action type: ${action.type}`)
  }
}

function ProfileForm() {
  const [state, dispatch] = useReducer(formReducer, initialFormState)

  const handleChange = (e) => {
    dispatch({
      type: 'change_field',
      payload: { name: e.target.name, value: e.target.value },
    })
  }

  const handleSubmit = (e) => {
    e.preventDefault()
    // ì„œë²„ ì „ì†¡ ë“± ë¡œì§...
    dispatch({ type: 'submit_success' })
  }

  return (
    <form onSubmit={handleSubmit}>
      <input
        name="name"
        placeholder="ì´ë¦„"
        value={state.name}
        onChange={handleChange}
      />
      <input
        name="email"
        placeholder="ì´ë©”ì¼"
        value={state.email}
        onChange={handleChange}
      />
      <input
        name="age"
        placeholder="ë‚˜ì´"
        value={state.age}
        onChange={handleChange}
      />
      <button type="submit">ì œì¶œ</button>
      <button type="button" onClick={() => dispatch({ type: 'reset' })}>
        ë¦¬ì…‹
      </button>

      {state.isSubmitted && <p>ì œì¶œ ì™„ë£Œ! ğŸ‰</p>}
    </form>
  )
}

export default ProfileForm
```

ì—¬ê¸°ì„œ í•µì‹¬ì€:

* **í•˜ë‚˜ì˜ change í•¸ë“¤ëŸ¬**ë¡œ ëª¨ë“  input ê´€ë¦¬
  (`change_field` ì•¡ì…˜)
* ì œì¶œ ì„±ê³µ / ë¦¬ì…‹ ê°™ì€ â€œí¼ì˜ ìƒíƒœ ì „ì´â€ê°€
  reducer ì•ˆì—ì„œ **ëª…í™•í•˜ê²Œ í‘œí˜„**ëœë‹¤ëŠ” ì ì…ë‹ˆë‹¤.

---

## 6. lazy initialization (init í•¨ìˆ˜) âš™ï¸

ì´ˆê¸° ìƒíƒœë¥¼ ê³„ì‚°í•˜ëŠ” ë¹„ìš©ì´ í° ê²½ìš° (ì˜ˆ: localStorage, ë³µì¡í•œ ê³„ì‚°)
`init` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ **ì´ˆê¸° ë Œë”ë§ ì‹œ í•œ ë²ˆë§Œ** ì‹¤í–‰í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 6-1. ë¬¸ë²•

```ts
const [state, dispatch] = useReducer(reducer, initialArg, init)
```

* `initialArg`: ì´ˆê¸°í™”ë¥¼ ìœ„í•œ â€œì›ì‹œ ê°’â€
* `init(initialArg)`: ì‹¤ì œ ì´ˆê¸° stateë¥¼ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜

### 6-2. ì˜ˆì œ: localStorageì—ì„œ ì´ˆê¸° ê°’ ì½ê¸°

```jsx
function init(initialCount) {
  // ì˜ˆ: ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ëœ ê°’ ìš°ì„  ì‚¬ìš©
  const stored = window.localStorage.getItem('count')
  if (stored !== null) {
    return { count: Number(stored) }
  }
  return { count: initialCount }
}

function reducer(state, action) {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 }
    default:
      return state
  }
}

function CounterWithStorage({ initialCount }) {
  const [state, dispatch] = useReducer(reducer, initialCount, init)

  useEffect(() => {
    window.localStorage.setItem('count', state.count)
  }, [state.count])

  return (
    <div>
      <p>Count: {state.count}</p>
      <button onClick={() => dispatch({ type: 'increment' })}>+1</button>
    </div>
  )
}
```

`init`ì€ **ì´ˆê¸° ë Œë”ë§ ë•Œë§Œ** í˜¸ì¶œë˜ë©°,
ì´í›„ `dispatch`ì— ì˜í•´ ì¬ë Œë”ë§ë  ë•ŒëŠ” ë‹¤ì‹œ í˜¸ì¶œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

## 7. useReducerì˜ êµ¬ì¡°ì /ì„±ëŠ¥ì  ì¥ì  âš–ï¸

### 7-1. dispatch í•¨ìˆ˜ëŠ” ì•ˆì •ì ì¸ ë ˆí¼ëŸ°ìŠ¤

ReactëŠ” `dispatch` í•¨ìˆ˜ë¥¼ ë Œë”ë§ë§ˆë‹¤ ìƒˆë¡œ ë§Œë“¤ì§€ ì•Šê³ ,
**ê°™ì€ í•¨ìˆ˜ ë ˆí¼ëŸ°ìŠ¤**ë¥¼ ì¬ì‚¬ìš©í•©ë‹ˆë‹¤.

ì¥ì :

* `dispatch`ë¥¼ ìì‹ ì»´í¬ë„ŒíŠ¸ì— propsë¡œ ë‚´ë ¤ë„
  ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì´ ì¤„ì–´ë“¦
* `useCallback`ìœ¼ë¡œ ê°ì‹¸ì¤„ í•„ìš”ê°€ ê±°ì˜ ì—†ìŒ

### 7-2. ì—¬ëŸ¬ state ëŒ€ì‹  í•œ state ê°ì²´

ë³µì¡í•œ ìƒíƒœë¥¼ `useState` ì—¬ëŸ¬ ê°œë¡œ ìª¼ê°œë©´:

* â€œì–´ë–¤ ì´ë²¤íŠ¸ê°€ ì–´ë–¤ stateë“¤ì„ ë™ì‹œì— ë°”ê¿¨ëŠ”ì§€â€ë¥¼ íŒŒì•…í•˜ê¸° ì–´ë ¤ì›€
* ì½”ë“œê°€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì´ê³³ì €ê³³ìœ¼ë¡œ í©ì–´ì§

useReducerëŠ”:

* **í•˜ë‚˜ì˜ state ê°ì²´**ë¡œ ë¬¶ê³ 
* ëª¨ë“  state ë³€ê²½ ë¡œì§ì„ **reducer í•œ ê³³**ìœ¼ë¡œ ëª¨ì•„ì„œ
  â€œìƒíƒœ ì „ì´ì˜ ì „ì²´ ê·¸ë¦¼â€ì„ ë³´ê¸° ì‰½ê²Œ í•©ë‹ˆë‹¤.

ì´ê±´ ìœ ì§€ë³´ìˆ˜/êµìœ¡ ê´€ì ì—ì„œ ì—„ì²­ ì¤‘ìš”í•œ í¬ì¸íŠ¸ì…ë‹ˆë‹¤. ğŸ§­

---

## 8. useReducer + Context = ë¯¸ë‹ˆ Redux ğŸ—ºï¸

ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ì „ì²´ì—ì„œ ê³µìœ í•˜ëŠ” ìƒíƒœê°€ í•„ìš”í•˜ë©´,
`useReducer`ì™€ `useContext`ë¥¼ ì¡°í•©í•´ ê°„ë‹¨í•œ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì²˜ëŸ¼ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 8-1. Store ë§Œë“¤ê¸°

```jsx
// store.js
import { createContext, useContext, useReducer } from 'react'

const initialState = {
  user: null,
  theme: 'light',
}

function appReducer(state, action) {
  switch (action.type) {
    case 'set_user':
      return { ...state, user: action.payload }
    case 'toggle_theme':
      return { ...state, theme: state.theme === 'light' ? 'dark' : 'light' }
    default:
      throw new Error(`Unknown action type: ${action.type}`)
  }
}

const AppStateContext = createContext(null)
const AppDispatchContext = createContext(null)

export function AppProvider({ children }) {
  const [state, dispatch] = useReducer(appReducer, initialState)

  return (
    <AppStateContext.Provider value={state}>
      <AppDispatchContext.Provider value={dispatch}>
        {children}
      </AppDispatchContext.Provider>
    </AppStateContext.Provider>
  )
}

export function useAppState() {
  const ctx = useContext(AppStateContext)
  if (!ctx) throw new Error('useAppState must be used within AppProvider')
  return ctx
}

export function useAppDispatch() {
  const ctx = useContext(AppDispatchContext)
  if (!ctx) throw new Error('useAppDispatch must be used within AppProvider')
  return ctx
}
```

### 8-2. ì‚¬ìš© ì˜ˆì‹œ

```jsx
// App.jsx
import { AppProvider } from './store'
import HomePage from './HomePage'

function App() {
  return (
    <AppProvider>
      <HomePage />
    </AppProvider>
  )
}

// HomePage.jsx
import { useAppState, useAppDispatch } from './store'

function HomePage() {
  const { user, theme } = useAppState()
  const dispatch = useAppDispatch()

  return (
    <div data-theme={theme}>
      <p>{user ? `${user.name}ë‹˜ ì•ˆë…•í•˜ì„¸ìš”` : 'ë¡œê·¸ì¸í•˜ì„¸ìš”'}</p>
      <button
        onClick={() =>
          dispatch({ type: 'set_user', payload: { name: 'í™ê¸¸ë™' } })
        }
      >
        ë¡œê·¸ì¸
      </button>

      <button
        onClick={() => dispatch({ type: 'toggle_theme' })}
      >
        í…Œë§ˆ í† ê¸€
      </button>
    </div>
  )
}
```

Reduxì˜ íŒ¨í„´ê³¼ ê±°ì˜ ë™ì¼í•˜ì§€ë§Œ:

* ë¯¸ë“¤ì›¨ì–´, DevTools, Thunk ë“±ì€ ì—†ìŒ
* ëŒ€ì‹  **ê°€ë³ê³ , í”„ë¡œì íŠ¸ ì˜ì¡´ì„±ì´ ì¦ê°€í•˜ì§€ ì•ŠìŒ**

---

## 9. ë‚´ë¶€ ë™ì‘ (ê³ ê¸‰): Fiber & hook.memoizedStateì™€ì˜ ê´€ê³„ ğŸ§¬

ì´ë¯¸ hook ë‚´ë¶€ë¥¼ ê¶ê¸ˆí•´í•˜ì…”ì„œ ğŸ˜‰ ì¡°ê¸ˆ ë” ê¹Šê²Œ ë³´ê² ìŠµë‹ˆë‹¤.
(ì‹¤ì œ êµ¬í˜„ì€ React ë²„ì „ë§ˆë‹¤ ë””í…Œì¼ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆê³ , ì—¬ê¸°ì„œëŠ” ê°œë… ìœ„ì£¼ì…ë‹ˆë‹¤.)

ê° í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ëŠ” React Fiber íŠ¸ë¦¬ì—ì„œ **í•˜ë‚˜ì˜ Fiber ë…¸ë“œ**ë¡œ í‘œí˜„ë©ë‹ˆë‹¤.

ì´ Fiber ë…¸ë“œì—ëŠ” ëŒ€ëµ ì´ëŸ° í•„ë“œë“¤ì´ ìˆìŠµë‹ˆë‹¤ (ê°œë…ì ìœ¼ë¡œ):

```ts
type Hook = {
  memoizedState: any
  baseState: any
  queue: UpdateQueue | null
  next: Hook | null
}
```

* **memoizedState**: í˜„ì¬ í›…ì˜ state (useReducerë¼ë©´ í˜„ì¬ state ê°ì²´)
* **queue**: ìƒˆë¡œìš´ ì—…ë°ì´íŠ¸(action)ê°€ ìŒ“ì´ëŠ” í
* **next**: ë‹¤ìŒ í›…ì„ ê°€ë¦¬í‚¤ëŠ” ì‹±ê¸€ ë§í¬ë“œ ë¦¬ìŠ¤íŠ¸

í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ ì‹¤í–‰ ì‹œ:

1. ReactëŠ” â€œí˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Fiberâ€ë¥¼ ê¸°ì–µí•©ë‹ˆë‹¤.
2. ì²« ë²ˆì§¸ `useReducer` í˜¸ì¶œ ì‹œ, ê·¸ Fiberì˜ í›… ë¦¬ìŠ¤íŠ¸ì—ì„œ ì²« ë²ˆì§¸ Hookì„ ì‚¬ìš©.
3. ë‹¤ìŒ `useReducer`/`useState` í˜¸ì¶œ ì‹œ, ê·¸ ë‹¤ìŒ Hookì„ ì‚¬ìš©.
4. ì´ëŸ° ì‹ìœ¼ë¡œ **í›…ì˜ í˜¸ì¶œ ìˆœì„œê°€ ê³§ í›…ì˜ â€œìŠ¬ë¡¯ ì¸ë±ìŠ¤â€**ê°€ ë©ë‹ˆë‹¤.

   * ê·¸ë˜ì„œ â€œì¡°ê±´ë¬¸ ì•ˆì—ì„œ í›… í˜¸ì¶œí•˜ë©´ ì•ˆ ëœë‹¤â€ëŠ” ê·œì¹™ì´ ìƒê¸´ ê±°ì£ .

`useReducer`ì˜ Hook êµ¬ì¡°ëŠ” ëŒ€ëµ:

```ts
hook.memoizedState = currentState
hook.baseState = baseState
hook.queue = {
  pending: Update | null,
  dispatch: function boundDispatch() { ... },
}
```

* **dispatch**ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ `boundDispatch(fiber, hook.queue)`ì²˜ëŸ¼
  íŠ¹ì • Fiberì™€ íì— ë°”ì¸ë”©ëœ í•¨ìˆ˜ì…ë‹ˆë‹¤.
* `dispatch(action)`ì„ í˜¸ì¶œí•˜ë©´:

  1. `queue.pending`ì— ìƒˆë¡œìš´ ì—…ë°ì´íŠ¸ ë…¸ë“œë¥¼ ì—°ê²°
  2. í•´ë‹¹ Fiberë¥¼ ë‹¤ì‹œ ë Œë”ë§ ëŒ€ìƒìœ¼ë¡œ ìŠ¤ì¼€ì¤„ë§
  3. ë‹¤ìŒ ë Œë”ë§ì—ì„œ `reducer`ë¥¼ ëŒë ¤ ìƒˆ state ê³„ì‚° í›„ `memoizedState` ì—…ë°ì´íŠ¸

ì¦‰, `useReducer`ì˜ stateëŠ” ê²°êµ­ **hook.memoizedStateì— ì €ì¥**ë˜ê³ ,
dispatchëŠ” ê·¸ Hookì˜ `queue`ì— ì—…ë°ì´íŠ¸ë¥¼ ìŒ“ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

---

## 10. Reduxì™€ useReducer ë¹„êµ âš”ï¸

ë‘˜ ë‹¤ **reducer íŒ¨í„´** + **action ê¸°ë°˜**ì´ë¼ëŠ” ê³µí†µì ì´ ìˆì§€ë§Œ, ì°¨ì´ì ë„ ë§ìŠµë‹ˆë‹¤.

| í•­ëª©       | useReducer               | Redux                             |
| -------- | ------------------------ | --------------------------------- |
| ì €ì¥ ìœ„ì¹˜    | React ì»´í¬ë„ŒíŠ¸ Fiber ë‚´ë¶€      | ì™¸ë¶€ store ê°ì²´                       |
| ë²”ìœ„       | íŠ¹ì • ì»´í¬ë„ŒíŠ¸ (ë˜ëŠ” Contextë¡œ ê³µìœ ) | ì•± ì „ì²´ ì „ì—­                           |
| DevTools | ê¸°ë³¸ ì—†ìŒ                    | Redux DevTools ì§€ì›                 |
| ë¯¸ë“¤ì›¨ì–´     | ì§ì ‘ êµ¬í˜„ í•„ìš”                 | redux-thunk, redux-saga ë“± í’ë¶€í•œ ìƒíƒœê³„ |
| ë¹„ë™ê¸° ì²˜ë¦¬   | useEffect ë“± React í›…ìœ¼ë¡œ ì²˜ë¦¬ | ë¯¸ë“¤ì›¨ì–´ íŒ¨í„´ í™œìš©                        |
| ì˜ì¡´ì„±      | React ë‚´ì¥                 | Redux íŒ¨í‚¤ì§€ ì¶”ê°€ í•„ìš”                   |

**ì •ë¦¬í•˜ìë©´:**

* **useReducer**:

  * â€œì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„â€ì˜ ë¯¸ë‹ˆ ìƒíƒœ ë¨¸ì‹ 
  * Contextì™€ í•©ì¹˜ë©´ ì‘ì€/ì¤‘ê°„ ê·œëª¨ ì•±ì˜ ì „ì—­ ìƒíƒœ ê´€ë¦¬ì— ì¶©ë¶„

* **Redux**:

  * ë³µì¡í•œ ê·œëª¨, DevTools, ë¯¸ë“¤ì›¨ì–´, time-travel ë””ë²„ê¹…ì´ í•„ìš”í•  ë•Œ

---

## 11. ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ & ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ âœ…

1. **reducerì—ì„œ side effectë¥¼ í•˜ëŠ” ê²½ìš°** âŒ

   * `fetch`, `console.log`, `localStorage` ê°™ì€ ê²ƒì€ `useEffect`ë¡œ ë¹¼ì•¼ í•©ë‹ˆë‹¤.

2. **stateë¥¼ ì§ì ‘ mutateí•˜ëŠ” ê²½ìš°** âŒ

   * `state.todos.push(...)`
   * `state.user.name = '...'`
     â†’ í•­ìƒ ìƒˆë¡œìš´ ê°ì²´/ë°°ì—´ì„ ë§Œë“¤ì–´ì„œ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤.

3. **action íƒ€ì… ë¬¸ìì—´ ì˜¤íƒ€**

   * `'add_todo'` vs `'addTodo'` ê°™ì€ ì˜¤íƒ€ ë°©ì§€ë¥¼ ìœ„í•´
     ìƒìˆ˜/enumì„ ì“°ê±°ë‚˜, TypeScriptë¡œ ê°•ì œí•˜ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.

4. ë„ˆë¬´ ë‹¨ìˆœí•œ ê²½ìš°ì— useReducerë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ

   * `count` í•˜ë‚˜ë§Œ ìˆëŠ” ì •ë§ ê°„ë‹¨í•œ ì¹´ìš´í„°ëŠ” `useState`ê°€ ë” ì½ê¸° ì‰½ìŠµë‹ˆë‹¤.
   * â€œìƒíƒœ ì „ì´ ë¡œì§ì´ ë³µì¡í•´ì§ˆ ë•Œâ€ useReducerë¡œ ì˜®ê¸°ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.

5. **dispatchë¥¼ ë‚¨ë°œí•˜ì—¬ í•œ ë Œë”ë§ ì‚¬ì´í´ì— ë„ˆë¬´ ë§ì´ í˜¸ì¶œí•˜ëŠ” ê²½ìš°**

   * React 18ì˜ concurrent íŠ¹ì§• ìƒ ì–´ëŠ ì •ë„ ë°°ì¹˜ëŠ” ë˜ì§€ë§Œ,
     í•˜ë‚˜ì˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë‚´ì—ì„œ ì—¬ëŸ¬ dispatchë¥¼ í˜¸ì¶œí•˜ë©´
     â€œreducer ì•ˆì—ì„œ í•œ ë²ˆì— ì²˜ë¦¬ ê°€ëŠ¥í•œ ê²ƒ ì•„ë‹Œê°€?â€ë¥¼ ë¨¼ì € ê³ ë¯¼í•´ë³´ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.

---

## 12. ë§ˆë¬´ë¦¬: ì–¸ì œ useReducerë¥¼ ì“°ë©´ ì¢‹ì€ê°€? ğŸ¯

ì •ë¦¬í•´ë³´ë©´, ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— **useReducer**ë¥¼ ê³ ë ¤í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤.

* ìƒíƒœê°€ **ê°ì²´/ë°°ì—´**ì´ê³ , í•„ë“œê°€ ë§ì•„ì§
* íŠ¹ì • ì´ë²¤íŠ¸ê°€ â€œì—¬ëŸ¬ stateë¥¼ ë™ì‹œì—â€ ë°”ê¿”ì•¼ í•¨
* ìƒíƒœ ì „ì´ê°€ **ëª…í™•í•œ ë‹¨ê³„(ë¡œë”© â†’ ì„±ê³µ â†’ ì‹¤íŒ¨)**ë¥¼ ê°€ì§
* â€œì•¡ì…˜â€ ë‹¨ìœ„ë¡œ ìƒíƒœ ë³€í™”ë¥¼ ëª¨ë¸ë§í•˜ê³  ì‹¶ìŒ (Reduxì™€ ìœ ì‚¬í•œ mental model)
* Contextë¡œ ì „ì—­ ìƒíƒœë¥¼ ë§Œë“¤ê³  ì‹¶ì§€ë§Œ, Redux ë„ì…ì€ ì˜¤ë²„í‚¬ì¼ ë•Œ


